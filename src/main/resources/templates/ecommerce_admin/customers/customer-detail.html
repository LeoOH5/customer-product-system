<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>고객 상세</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-4">

<div th:replace="fragments :: navbar"></div>
<div th:replace="fragments :: flash"></div>

<h2>고객 상세</h2>

<div class="card mb-4">
    <div class="card-body">
        <p><strong>이름:</strong> <span th:text="${customer.name}">홍길동</span></p>
        <p><strong>이메일:</strong> <span th:text="${customer.email}">hong@test.com</span></p>
        <p><strong>전화번호:</strong> <span th:text="${customer.phone}">010-1234-5678</span></p>
        <div class="mt-3">
            <a th:href="@{/customers/edit/{id}(id=${customer.id})}" class="btn btn-warning btn-sm">수정</a>
            <form th:action="@{/customers/delete/{id}(id=${customer.id})}" method="post" class="d-inline" onsubmit="return confirm('삭제하시겠습니까?')">
                <input type="hidden" name="_method" value="delete"/>
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <button type="submit" class="btn btn-danger btn-sm">삭제</button>
            </form>
        </div>
    </div>
</div>

<h4>구매 이력</h4>
<table class="table table-bordered align-middle">
    <thead>
        <tr>
            <th>주문 ID</th>
            <th>상품명</th>
            <th>수량</th>
            <th>가격</th>
            <th>주문일자</th>
        </tr>
    </thead>
    <tbody>
        <tr th:each="order : ${orders}">
            <td th:text="${order.id}">101</td>
            <td th:text="${order.product.name}">노트북</td>
            <td th:text="${order.quantity}">1</td>
            <td th:text="${#numbers.formatInteger(order.product.price, 3, 'COMMA')}">1,200,000</td>
            <td th:text="${#temporals.format(order.orderDate, 'yyyy-MM-dd')}">2025-09-15</td>
        </tr>
    </tbody>
</table>

<!-- 고객 구매이력 페이지네이션(ordersCurrentPage/ordersTotalPages 필요) -->
<nav th:if="${ordersTotalPages != null and ordersTotalPages > 1}" aria-label="orders-page">
  <ul class="pagination">
    <li class="page-item" th:classappend="${ordersCurrentPage == 0} ? 'disabled'">
      <a class="page-link" th:href="@{/customers/{id}(id=${customer.id}, ordersPage=${ordersCurrentPage-1})}">이전</a>
    </li>
    <li class="page-item" th:each="i : ${#numbers.sequence(0, ordersTotalPages-1)}" th:classappend="${i == ordersCurrentPage} ? 'active'">
      <a class="page-link" th:text="${i+1}" th:href="@{/customers/{id}(id=${customer.id}, ordersPage=${i})}">1</a>
    </li>
    <li class="page-item" th:classappend="${ordersCurrentPage == ordersTotalPages-1} ? 'disabled'">
      <a class="page-link" th:href="@{/customers/{id}(id=${customer.id}, ordersPage=${ordersCurrentPage+1})}">다음</a>
    </li>
  </ul>
</nav>

<a href="/customers" class="btn btn-secondary mt-2">목록으로</a>

</body>
</html>
